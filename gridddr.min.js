!function(e){e.gridddr=function(a){return e("body").gridddr(a,!0)},e.fn.gridddr=function(a,i){var t={debug:!1,relative:!1,container:null,itemClass:!1,itemTag:"img",defaultClasses:{container:".gridddr-container",item:".gridddr-item",overlay:".gridddr-overlay",nowrap:".gridddr-nowrap-container",invisible:".gridddr-invisible",separator:".gridddr-separator",fitImage:".fit-image",scrollable:".gridddr-non-scrollable",imgPlaceholder:".loaded-image",slideUp:".gridddr-slideup",flipper:{flipFront:".gridddr-flipper-front",flipBack:".gridddr-flipper-back",flipWrapper:".gridddr-flipper",flipContainer:".gridddr-flip-container",opened:"opened"}},scrollableContainer:!1,fitContainer:!1,fitImage:!1,saveNode:!1,itemWidth:150,itemHeight:150,preloading:!0,useQueue:!0,shuffleQueue:!0,queueDelay:50,overlay:!0,overlayOpacity:.6,gridX:!1,gridY:!1,repeat:!0,useGPU:!0,animations:!0,animationType:"fade",animationsSpeed:1e3,events:{}},s={window:{onResize:function(){e(r.defaultClasses.container).each(function(a,i){n.updateGrid(e(i),e(i).find(r.defaultClasses.item))})}},container:{beforeInit:function(){},onInit:function(){alert()}}},r=e.extend(t,a),n={findGridddrItems:function(e){var a=r.itemTag&&r.itemClass?r.itemTag+r.itemClass:!1||r.itemTag||r.itemClass||"*";return n.debug("Looking for:",a),e.find(">"+a)},generateWrapper:function(a){var i;switch(r.animationType.toLowerCase()){case"flip":i=a.wrap(e("<div/>",{"class":r.defaultClasses.flipper.flipFront.slice(1)})).parent().wrap(e("<div/>",{"class":r.defaultClasses.flipper.flipWrapper.slice(1)})).parent().append(e("<div/>",{"class":r.defaultClasses.flipper.flipBack.slice(1)})).wrap(e("<div/>",{"class":r.defaultClasses.flipper.flipContainer.slice(1)})).parent();break;default:i=a.wrap(e("<div/>",{"class":r.defaultClasses.item.slice(1)})).parent()}return i},wrapItems:function(a){var i=n.findGridddrItems(a);return i.size()>0&&i.each(function(){var a=r.saveNode?e(this):n.generateWrapper(e(this));r.preloading&&n.prepareForPreloading(a),r.fitImage&&a.addClass(r.defaultClasses.fitImage.slice(1)),r.defaultClasses.item&&!a.hasClass(r.defaultClasses.item.slice(1))&&a.addClass(r.defaultClasses.item.slice(1)),r.itemWidth&&a.width(Number(r.itemWidth)),r.itemHeight&&a.height(Number(r.itemHeight))}),n.createGrid(a,i)},setRelativeClass:function(e,a){var a=a||r.relative||!1;return a?e.addClass("relative"):e.removeClass("relative"),!0},grepItemsByEq:function(a,i){return e.grep(a,function(e,a){return(a+1)%Number(i)==0})},createGrid:function(a,i){return a.addClass(r.defaultClasses.nowrap.slice(1)),r.scrollableContainer||a.addClass(r.defaultClasses.scrollable.slice(1)),a.each(function(){n.updateGrid(e(this),i)}),!0},updateGrid:function(a,i){if(r.gridX&&"number"==typeof r.gridX&&Number(r.gridX)>0){var i=n.grepItemsByEq(i,r.gridX);e.each(i,n.insertSeparator)}else if("number"==typeof r.itemWidth){var t=a.width()/r.itemWidth||10;t=r.fitContainer?Math.floor(t):Math.ceil(t),e.each(n.grepItemsByEq(i,t),n.insertSeparator)}return!0},insertSeparator:function(a,i){var t=e(i);if(!r.saveNode)switch(r.animationType){case"flip":t=t.parents().eq(2);break;default:t=t.parent()}return e("<div/>",{"class":r.defaultClasses.separator.slice(1)}).insertAfter(t),!0},overlay:function(a){if(0!=r.overlay){var i=e(a.find(r.defaultClasses.overlay).get(0)||a.prepend(e("<div/>",{"class":r.defaultClasses.overlay.slice(1)})).find(r.defaultClasses.overlay).get(0));"true"!=r.overlay.toString()&&n.css(i,"background-color",r.overlay.toString()),"number"==typeof r.overlayOpacity?n.css(i,"opacity",Number(r.overlayOpacity)):"boolean"==typeof r.overlayOpacity&&n.css(i,"opacity",Math.min(.8,Number(r.overlayOpacity)))}return!0},css:function(e,a,i,t){if(r.animations){if("object"!=typeof a){var s=a;a={},a[s]=i,delete s,delete i}e.animate(a,r.animationsSpeed||0,t||!1)}else e.css(a,i||!1),"function"==typeof t?t.call():"function"==typeof window[t]?window[t]():n.debug(t,"function dows not exist.");return!0},prepareForPreloading:function(e){switch(r.saveNode&&"flip"==r.animationType.toLowerCase()&&(r.animationType="fade"),r.animationType.toLowerCase()){case"flip":e.addClass(r.defaultClasses.flipper.opened);break;default:e.addClass(r.defaultClasses.invisible.slice(1)),"slide"===r.animationType.toLowerCase()&&e.addClass(r.defaultClasses.slideUp.slice(1))}return!0},loadImage:function(e,a,i,t){e.attr("src",i).removeData("src"),r.preloading&&e.addClass(r.defaultClasses.imgPlaceholder.slice(1)),r.useQueue?(t.push(e),t.length==a&&n.queuePromise.resolve()):n.loadedCallback.apply(e)},preloadContent:function(a){var i=e(a).find(r.defaultClasses.item),t=this.queue,s=i.size();if(r.saveNode||(i=i.find("[data-src]")),r.preloading&&s>0)try{i.each(function(){var a=e(this),i=a.data("src");e("<img>").attr("src",i).one("load",function(){n.loadImage(a,s,i,t)}).on("error",function(a){n.debug("Error while loading image: ",a,e(a.delegateTarget))})})}catch(l){n.queuePromise.reject(l)}else i.each(function(){n.loadImage(e(this),s,e(this).data("src"),t)});return!0},loadedCallback:function(){if(r.preloading)switch(r.animationType.toLowerCase()){case"flip":return e(this).removeClass(r.defaultClasses.imgPlaceholder.slice(1)).parents().eq(2).removeClass(r.defaultClasses.flipper.opened);default:var a=e(this).removeClass(r.defaultClasses.imgPlaceholder.slice(1));return r.saveNode||(a=a.parent()),"slide"===r.animationType.toLowerCase()&&a.removeClass(r.defaultClasses.slideUp.slice(1)),a.removeClass(r.defaultClasses.invisible.slice(1))}},createQueue:function(){return this.queue=[],this.queuePromise=e.Deferred(),this.queuePromise.done(this.execQueue),this.queuePromise.fail(function(a){n.debug("Preloading images failed: ",a),this.queue.length>0&&this.execQueue(this.queue),($images=e(r.defaultClasses.container).find(r.defaultClasses.item).find("[data-src]")&&$images.size()>0)&&$images.each(n.loadedCallback)}),this.queue},shuffleQueue:function(e){for(var a,i,t=e.length;t;)i=Math.floor(Math.random()*t--),a=e[t],e[t]=e[i],e[i]=a;return e},execQueue:function(a){var a=a||n.queue;r.shuffleQueue&&(a=n.shuffleQueue(a)),e.each(a,function(a){var i=e(this);setTimeout(function(){n.loadedCallback.apply(i)},a*Number(r.queueDelay))})},debug:function(){return r.debug&&console?(console.log.apply(console,arguments),!0):!1},bindEvents:function(a){var i;return r.events&&"object"==typeof r.events&&(s=e.extend(r.events.window||r.events.container?s.container:s,r.events)),e.each(s,function(t,s){switch(t.toString()){case"window":i=e(window);break;default:i=a}e.each(s,function(e,a){n.debug("Binding",e,"to",i),i.bind(e,a)})})},inititalize:function(a,i){var t=e(i);return n.bindEvents(t),t.trigger("onInit"),t.css("opacity",0),t.hasClass(r.defaultClasses.container.slice(1))||t.addClass(r.defaultClasses.container.slice(1)),r.relative&&n.setRelativeClass(t,!0),n.overlay(t)&&n.wrapItems(t)&&!t.data("inititalized")?(r.useQueue&&n.createQueue.apply(n),n.preloadContent.apply(n,t),t.data("inititalized",!0).css("opacity",1),n.debug(i,"inititalized as Gridddr."),!0):(n.debug("Something went wrong"),!1)}},l={getSettings:function(){return r},setOverlayOpacity:function(a){var a=a||!!a;return r.overlayOpacity=Number(a),n.overlay(e(r.defaultClasses.container)),this},getBindedEvents:function(a){var i=a||e(this),t=e.map(e._data(i.get(0),"events"),function(e,a){var i={name:e,body:a};return i});return n.debug("There are",t?t.length:0,"events binded to",i.get(0).tagName+(i.attr("id")?"#"+i.attr("id"):"")+(i.attr("class")?"."+i.attr("class").replace(/\s+/g,"."):""),":\n",t),t}};return e.extend(this,l),e.each(this,n.inititalize),this}}(jQuery);